<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Data Management System</title>
  <link rel="stylesheet" href="style.css">
  <script type="module">
  // Import Firebase modules
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getDatabase, ref, set, get, child, remove } 
    from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

  // Your Firebase config (from console)
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "123456789",
    appId: "YOUR_APP_ID"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Save student
  window.addStudent = function(student) {
    set(ref(db, "students/" + student.roll), student);
  };

  // Get all students
  window.getStudents = async function() {
    const snapshot = await get(child(ref(db), "students"));
    if (snapshot.exists()) {
      console.log(snapshot.val());
    }
  };

  // Delete student
  // window.deleteStudent = function(roll) {
  //   remove(ref(db, "students/" + roll));
  // };

  window.deleteStudent = function(index){ students.splice(index,1); saveData(); renderTable(); }

</script>

</head>
<body>
  <img src="MIT-CSN.png" alt="MIT-CSN">
  <h1>Student Data Management System</h1>
   
  <form id="studentForm">
    <input type="text" id="roll" placeholder="Roll No" required>
    <input type="text" id="name" placeholder="Name" required>
    <input type="text" id="class" placeholder="Class" required>
    <input type="number" id="marks" placeholder="Marks" required>
    
    <!-- extra fields -->
    <input type="text" id="hallTicket" placeholder="Hall Ticket No" required>
    <input type="text" id="erp" placeholder="ERP No" required>
    <input type="text" id="blood" placeholder="Blood Group" required>
    <input type="date" id="dob" placeholder="Birth Date" required>
    <input type="tel" id="mobile" placeholder="Mobile Number" required pattern="[0-9]{10}">
    
    <button type="submit">Add Student</button>
  </form>

  <input type="text" id="search" placeholder="Search by Name, Roll No, ERP or Mobile">

  <table>
    <thead>
      <tr>
        <th>Roll No</th>
        <th>Name</th>
        <th>Class</th>
        <th>Marks</th>
        <th>Hall Ticket</th>
        <th>ERP No</th>
        <th>Blood Group</th>
        <th>Birth Date</th>
        <th>Mobile</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="studentTable"></tbody>
  </table>

  <script>
    let students = JSON.parse(localStorage.getItem("students")) || [];

    const form = document.getElementById("studentForm");
    const table = document.getElementById("studentTable");
    const search = document.getElementById("search");

    function saveData() {
      localStorage.setItem("students", JSON.stringify(students));
    }

    function renderTable() {
      table.innerHTML = "";
      students.forEach((student, index) => {
        let row = `
          <tr>
            <td>${student.roll}</td>
            <td>${student.name}</td>
            <td>${student.class}</td>
            <td>${student.marks}</td>
            <td>${student.hallTicket}</td>
            <td>${student.erp}</td>
            <td>${student.blood}</td>
            <td>${student.dob}</td>
            <td>${student.mobile}</td>
            <td class="actions">
              <button onclick="editStudent(${index})">Edit</button>
              <button onclick="deleteStudent(${index})">Delete</button>
            </td>
          </tr>`;
        table.innerHTML += row;
      });
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const roll = document.getElementById("roll").value;
      const name = document.getElementById("name").value;
      const cls = document.getElementById("class").value;
      const marks = document.getElementById("marks").value;
      const hallTicket = document.getElementById("hallTicket").value;
      const erp = document.getElementById("erp").value;
      const blood = document.getElementById("blood").value;
      const dob = document.getElementById("dob").value;
      const mobile = document.getElementById("mobile").value;

      students.push({ roll, name, class: cls, marks, hallTicket, erp, blood, dob, mobile });
      saveData();
      renderTable();
      form.reset();
    });

    function editStudent(index) {
      let student = students[index];
      document.getElementById("roll").value = student.roll;
      document.getElementById("name").value = student.name;
      document.getElementById("class").value = student.class;
      document.getElementById("marks").value = student.marks;
      document.getElementById("hallTicket").value = student.hallTicket;
      document.getElementById("erp").value = student.erp;
      document.getElementById("blood").value = student.blood;
      document.getElementById("dob").value = student.dob;
      document.getElementById("mobile").value = student.mobile;

      students.splice(index, 1);
      saveData();
      renderTable();
    }

    function deleteStudent(index) {
      students.splice(index, 1);
      saveData();
      renderTable();
    }

    search.addEventListener("input", () => {
      const term = search.value.toLowerCase();
      table.innerHTML = "";
      students
        .filter(s => 
          s.name.toLowerCase().includes(term) || 
          s.roll.toLowerCase().includes(term) || 
          s.erp.toLowerCase().includes(term) || 
          s.mobile.toLowerCase().includes(term)
        )
        .forEach((student, index) => {
          let row = `
            <tr>
              <td>${student.roll}</td>
              <td>${student.name}</td>
              <td>${student.class}</td>
              <td>${student.marks}</td>
              <td>${student.hallTicket}</td>
              <td>${student.erp}</td>
              <td>${student.blood}</td>
              <td>${student.dob}</td>
              <td>${student.mobile}</td>
              <td class="actions">
                <button onclick="editStudent(${index})">Edit</button>
                <button onclick="deleteStudent(${index})">Delete</button>
              </td>
            </tr>`;
          table.innerHTML += row;
        });
    });

    renderTable();

  </script>



</body>
</html>
